# Ассемблер для УВМ

Это CLI-приложение ассемблера для учебной виртуальной машины (УВМ). Оно транслирует человекочитаемый язык ассемблера из YAML-файла в бинарный формат.

## Как запустить

Для ассемблирования программы используйте следующую команду:

```bash
python uvm-asm.py <input_file.yaml> <output_file.bin>
```

**Аргументы:**

*   `<input_file.yaml>`: Путь к исходному файлу с программой в формате YAML.
*   `<output_file.bin>`: Путь для записи результирующего бинарного кода.

**Опции:**

*   `--test`: Включает режим тестирования. В этом режиме ассемблер выведет на экран промежуточное представление программы и выполнит тесты для проверки соответствия спецификации.

**Пример:**

```bash
python uvm-asm.py uvm-input.yaml uvm-output.bin --test
```

## Язык ассемблера

Программа описывается в YAML-файле под ключом `program`, который содержит список инструкций. Каждая инструкция — это объект с полем `op`, указывающим операцию, и другими полями для её аргументов.

### `ldc` (Загрузка константы)

Загружает константное значение в регистр.

**Синтаксис:**

```yaml
- op: ldc
  const: <значение>
  addr: <адрес_регистра>
```

*   `const`: Константа для загрузки (до 24 бит).
*   `addr`: Адрес целевого регистра (до 6 бит).

### `read` (Чтение из памяти)

Читает значение из памяти в регистр. Адрес в памяти вычисляется как сумма значения базового регистра и смещения.

**Синтаксис:**

```yaml
- op: read
  offset: <смещение>
  addr1: <адрес_базового_регистра>
  addr2: <адрес_целевого_регистра>
```

*   `offset`: Смещение, добавляемое к базовому адресу (до 7 бит).
*   `addr1`: Адрес базового регистра (до 6 бит).
*   `addr2`: Адрес целевого регистра (до 6 бит).

### `write` (Запись в память)

Записывает значение регистра в память. Адрес в памяти определяется значением другого регистра.

**Синтаксис:**

```yaml
- op: write
  addr1: <регистр_с_адресом>
  addr2: <регистр_с_данными>
```

*   `addr1`: Регистр, содержащий адрес в памяти для записи (до 6 бит).
*   `addr2`: Регистр, содержащий записываемое значение (до 6 бит).

### `rsh` (Арифметический сдвиг вправо)

Выполняет побитовый арифметический сдвиг вправо.

**Синтаксис:**

```yaml
- op: rsh
  addr1: <базовый_регистр_назначения>
  offset1: <смещение_назначения>
  offset2: <смещение_операнда_2>
  addr2: <базовый_регистр_операнда_2>
  addr3: <регистр_операнда_1>
```

*   `addr1`: Базовый регистр для адреса назначения (до 6 бит).
*   `offset1`: Смещение для адреса назначения (до 7 бит).
*   `offset2`: Смещение для адреса второго операнда в памяти (до 7 бит).
*   `addr2`: Базовый регистр для адреса второго операнда (до 6 бит).
*   `addr3`: Регистр первого операнда (до 6 бит).
```